//
// Created by Bitter Nectar on 30.03.2025.
//
#include "chip8.h"

#include <string.h>

const uint8_t chip8_fontset[80] = {
    0xF0, 0x90, 0x90, 0x90, 0xF0, // 0
    0x20, 0x60, 0x20, 0x20, 0x70, // 1
    0xF0, 0x10, 0xF0, 0x80, 0xF0, // 2
    0xF0, 0x10, 0xF0, 0x10, 0xF0, // 3
    0x90, 0x90, 0xF0, 0x10, 0x10, // 4
    0xF0, 0x80, 0xF0, 0x10, 0xF0, // 5
    0xF0, 0x80, 0xF0, 0x90, 0xF0, // 6
    0xF0, 0x10, 0x20, 0x40, 0x40, // 7
    0xF0, 0x90, 0xF0, 0x90, 0xF0, // 8
    0xF0, 0x90, 0xF0, 0x10, 0xF0, // 9
    0xF0, 0x90, 0xF0, 0x90, 0x90, // A
    0xE0, 0x90, 0xE0, 0x90, 0xE0, // B
    0xF0, 0x80, 0x80, 0x80, 0xF0, // C
    0xE0, 0x90, 0x90, 0x90, 0xE0, // D
    0xF0, 0x80, 0xF0, 0x80, 0xF0, // E
    0xF0, 0x80, 0xF0, 0x80, 0x80  // F
};

void init_chip_8(Chip_8 *chip) {
    chip->PC = START_RAM_ADDR;
    chip->I = 0;
    chip->SP = 0;
    chip->VF = 0;
    chip->DT = 0;
    chip->ST = 0;

    memset(chip->RAM, 0, sizeof(chip->RAM));
    memset(chip->display_buffer, 0, sizeof(chip->display_buffer));
    memset(chip->keyboard, 0, sizeof(chip->keyboard));
    memset(chip->stack, 0, sizeof(chip->stack));

    // Загрузка шрифтов в память
    memcpy(chip->RAM, chip8_fontset, sizeof(chip8_fontset));
}
